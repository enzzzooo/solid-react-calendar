import e from"../../@babel/runtime/helpers/esm/extends.js";import t from"../../@babel/runtime/helpers/esm/assertThisInitialized.js";import r from"../../@babel/runtime/helpers/esm/inheritsLoose.js";import o from"../../memoize-one/dist/memoize-one.esm.js";import{createElement as i,PureComponent as n}from"react";var l="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function s(e){cancelAnimationFrame(e.id)}var a=-1;function c(e){if(void 0===e&&(e=!1),-1===a||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),a=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return a}var u=null;function d(e){if(void 0===e&&(e=!1),null===u||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var o=document.createElement("div"),i=o.style;return i.width="100px",i.height="100px",t.appendChild(o),document.body.appendChild(t),t.scrollLeft>0?u="positive-descending":(t.scrollLeft=1,u=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),u}return u}process.env.NODE_ENV;var f=function(e,t){return e},h=null,p=null;function m(a){var u,h=a.getItemOffset,p=a.getEstimatedTotalSize,m=a.getItemSize,g=a.getOffsetForIndexAndAlignment,S=a.getStartIndexForOffset,y=a.getStopIndexForStartIndex,_=a.initInstanceProps,w=a.shouldResetStyleCacheOnItemSizeChange,I=a.validateProps;return u=function(n){function a(e){var r;return(r=n.call(this,e)||this)._instanceProps=_(r.props,t(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:t(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof r.props.initialScrollOffset?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=o((function(e,t,o,i){return r.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:o,visibleStopIndex:i})})),r._callOnScroll=void 0,r._callOnScroll=o((function(e,t,o){return r.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:o})})),r._getItemStyle=void 0,r._getItemStyle=function(e){var t,o=r.props,i=o.direction,n=o.itemSize,l=o.layout,s=r._getItemStyleCache(w&&n,w&&l,w&&i);if(s.hasOwnProperty(e))t=s[e];else{var a=h(r.props,e,r._instanceProps),c=m(r.props,e,r._instanceProps),u="horizontal"===i||"horizontal"===l,d="rtl"===i,f=u?a:0;s[e]=t={position:"absolute",left:d?void 0:f,right:d?f:void 0,top:u?0:a,height:u?"100%":c,width:u?c:"100%"}}return t},r._getItemStyleCache=void 0,r._getItemStyleCache=o((function(e,t,r){return{}})),r._onScrollHorizontal=function(e){var t=e.currentTarget,o=t.clientWidth,i=t.scrollLeft,n=t.scrollWidth;r.setState((function(e){if(e.scrollOffset===i)return null;var t=r.props.direction,l=i;if("rtl"===t)switch(d()){case"negative":l=-i;break;case"positive-descending":l=n-o-i}return l=Math.max(0,Math.min(l,n-o)),{isScrolling:!0,scrollDirection:e.scrollOffset<l?"forward":"backward",scrollOffset:l,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._onScrollVertical=function(e){var t=e.currentTarget,o=t.clientHeight,i=t.scrollHeight,n=t.scrollTop;r.setState((function(e){if(e.scrollOffset===n)return null;var t=Math.max(0,Math.min(n,i-o));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){var e,t,o,i;null!==r._resetIsScrollingTimeoutId&&s(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=(e=r._resetIsScrolling,t=150,o=l(),i={id:requestAnimationFrame((function r(){l()-o>=t?e.call(null):i.id=requestAnimationFrame(r)}))})},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1,null)}))},r}r(a,n),a.getDerivedStateFromProps=function(e,t){return v(e,t),I(e),null};var u=a.prototype;return u.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},u.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props,o=r.itemCount,i=r.layout,n=this.state.scrollOffset;e=Math.max(0,Math.min(e,o-1));var l=0;if(this._outerRef){var s=this._outerRef;l="vertical"===i?s.scrollWidth>s.clientWidth?c():0:s.scrollHeight>s.clientHeight?c():0}this.scrollTo(g(this.props,e,t,n,this._instanceProps,l))},u.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,o=e.layout;if("number"==typeof r&&null!=this._outerRef){var i=this._outerRef;"horizontal"===t||"horizontal"===o?i.scrollLeft=r:i.scrollTop=r}this._callPropsCallbacks()},u.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,o=this.state,i=o.scrollOffset;if(o.scrollUpdateWasRequested&&null!=this._outerRef){var n=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(d()){case"negative":n.scrollLeft=-i;break;case"positive-ascending":n.scrollLeft=i;break;default:var l=n.clientWidth,s=n.scrollWidth;n.scrollLeft=s-l-i}else n.scrollLeft=i;else n.scrollTop=i}this._callPropsCallbacks()},u.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&s(this._resetIsScrollingTimeoutId)},u.render=function(){var t=this.props,r=t.children,o=t.className,n=t.direction,l=t.height,s=t.innerRef,a=t.innerElementType,c=t.innerTagName,u=t.itemCount,d=t.itemData,h=t.itemKey,m=void 0===h?f:h,v=t.layout,g=t.outerElementType,S=t.outerTagName,y=t.style,_=t.useIsScrolling,w=t.width,I=this.state.isScrolling,b="horizontal"===n||"horizontal"===v,z=b?this._onScrollHorizontal:this._onScrollVertical,O=this._getRangeToRender(),x=O[0],R=O[1],T=[];if(u>0)for(var C=x;C<=R;C++)T.push(i(r,{data:d,key:m(C,d),index:C,isScrolling:_?I:void 0,style:this._getItemStyle(C)}));var M=p(this.props,this._instanceProps);return i(g||S||"div",{className:o,onScroll:z,ref:this._outerRefSetter,style:e({position:"relative",height:l,width:w,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:n},y)},i(a||c||"div",{children:T,ref:s,style:{height:b?"100%":M,pointerEvents:I?"none":void 0,width:b?M:"100%"}}))},u._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],o=e[2],i=e[3];this._callOnItemsRendered(t,r,o,i)}if("function"==typeof this.props.onScroll){var n=this.state,l=n.scrollDirection,s=n.scrollOffset,a=n.scrollUpdateWasRequested;this._callOnScroll(l,s,a)}},u._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,o=this.state,i=o.isScrolling,n=o.scrollDirection,l=o.scrollOffset;if(0===t)return[0,0,0,0];var s=S(this.props,l,this._instanceProps),a=y(this.props,s,l,this._instanceProps),c=i&&"backward"!==n?1:Math.max(1,r),u=i&&"forward"!==n?1:Math.max(1,r);return[Math.max(0,s-c),Math.max(0,Math.min(t-1,a+u)),s,a]},a}(n),u.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},u}"production"!==process.env.NODE_ENV&&"undefined"!=typeof window&&void 0!==window.WeakSet&&(h=new WeakSet,p=new WeakSet);var v=function(e,t){var r=e.children,o=e.direction,i=e.height,n=e.layout,l=e.innerTagName,s=e.outerTagName,a=e.width,c=t.instance;if("production"!==process.env.NODE_ENV){null==l&&null==s||p&&!p.has(c)&&(p.add(c),console.warn("The innerTagName and outerTagName props have been deprecated. Please use the innerElementType and outerElementType props instead."));var u="horizontal"===o||"horizontal"===n;switch(o){case"horizontal":case"vertical":h&&!h.has(c)&&(h.add(c),console.warn('The direction prop should be either "ltr" (default) or "rtl". Please use the layout prop to specify "vertical" (default) or "horizontal" orientation.'));break;case"ltr":case"rtl":break;default:throw Error('An invalid "direction" prop has been specified. Value should be either "ltr" or "rtl". "'+o+'" was specified.')}switch(n){case"horizontal":case"vertical":break;default:throw Error('An invalid "layout" prop has been specified. Value should be either "horizontal" or "vertical". "'+n+'" was specified.')}if(null==r)throw Error('An invalid "children" prop has been specified. Value should be a React component. "'+(null===r?"null":typeof r)+'" was specified.');if(u&&"number"!=typeof a)throw Error('An invalid "width" prop has been specified. Horizontal lists must specify a number for width. "'+(null===a?"null":typeof a)+'" was specified.');if(!u&&"number"!=typeof i)throw Error('An invalid "height" prop has been specified. Vertical lists must specify a number for height. "'+(null===i?"null":typeof i)+'" was specified.')}},g=m({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,r,o,i,n){var l=e.direction,s=e.height,a=e.itemCount,c=e.itemSize,u=e.layout,d=e.width,f="horizontal"===l||"horizontal"===u?d:s,h=Math.max(0,a*c-f),p=Math.min(h,t*c),m=Math.max(0,t*c-f+c+n);switch("smart"===r&&(r=o>=m-f&&o<=p+f?"auto":"center"),r){case"start":return p;case"end":return m;case"center":var v=Math.round(m+(p-m)/2);return v<Math.ceil(f/2)?0:v>h+Math.floor(f/2)?h:v;default:return o>=m&&o<=p?o:o<m?m:p}},getStartIndexForOffset:function(e,t){var r=e.itemCount,o=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/o)))},getStopIndexForStartIndex:function(e,t,r){var o=e.direction,i=e.height,n=e.itemCount,l=e.itemSize,s=e.layout,a=e.width,c=t*l,u="horizontal"===o||"horizontal"===s?a:i,d=Math.ceil((u+r-c)/l);return Math.max(0,Math.min(n-1,t+d-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){var t=e.itemSize;if("production"!==process.env.NODE_ENV&&"number"!=typeof t)throw Error('An invalid "itemSize" prop has been specified. Value should be a number. "'+(null===t?"null":typeof t)+'" was specified.')}});export{g as FixedSizeList};
//# sourceMappingURL=index.esm.js.map
